---


- hosts: nodes
  become: true
  become_method: sudo
  tasks:
  - name: update packages
    apt:
      upgrade: yes
      update_cache: yes
      cache_valid_time: 86400  # 86400: 1 day
  - name: install common packages
    package:
      name: "{{ item }}"
      state: present
    with_items: "{{ base_common_packages }}"
  vars:
    base_common_packages:
      - curl
      - fzf
      - git
      - htop
      - python3-pip
      - software-properties-common
      - unzip
      - vim
      - wget

- hosts: mercury
  become: true
  become_method: sudo
  tasks:
  - name: ensure apache is at the latest version
    apt: name=apache2 state=latest
  - name: ensure apache is running
    service: name=apache2 state=started enabled=yes